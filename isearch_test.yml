include: [isearch]

test:
  desc: Test iSearch
  type: input_page
  inputs:
    - country: { type: isearch }
    - bound: { value: <didi test }
  actions: [test]
  post: [write_session: $test]


country:
  # table: country
  sql: select code, name from country
  fields: [code, name]
  flags: [show_all]
  adder: /isearch_test/add
  choose: $name ($code)

add:
  desc: Add new country
  width: 400
  type: input_page
  inputs:
    - new_country_code
    - new_country_name
  actions: [add]
  post:
    - sql_insert: [country, code: $new_country_code, name: $new_country_name]
    - close_dialog
    - trigger: [autocompleteadded,"#country", [$new_country_code, $new_country_name] ]

new_country_code:
  name: Country Code
  valid: unique(country.code)

new_country_name:
  name: Country Name
  valid: unique(country.name)
