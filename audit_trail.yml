include: [datatable]
base:
  type: datatable
  sort: when
  sort_order: desc
  page_size: 15
  flags:
    - filter
    - show_header
    - show_titles
  report_title: User Audit Trail
  actions:
    - print
    - export
  fields:
    - when: { width: 12%,name: Time }
    - first_name: { width: 10% }
    - last_name: { width: 16% }
    - email: { width: 18% }
    - what: { width: 18%, name: Action }
    - detail: { width: 35% }


user:
  type: base
  name: My Audit Trail
  access: [reg]
  values:
    - collection.values: [session, $sid, user]
    - collection.data: [audit, user: $user, time, user.first_name, user.last_name, user, action, detail]
    - clear_values: [user]

partner:
  name: Organisation Audit Trail
  type: base
  access: [admin]
  values:
    - collection.values: [session, $sid, partner]
    - collection.data: [audit, partner: $partner, time, user.first_name, user.last_name, user, action, detail]
    - clear_values: [partner]

system:
  name: System Audit Trail
  type: base
  access: [admin]
  fields:
    - organisation: { push: first_name, width: 12% }
  values:
    - collection.data: [audit, "", time, partner.name, user.first_name, user.last_name, user, action, detail]
