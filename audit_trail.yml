include: [datatable]
user:
  type: datatable
  access: auth
  name: My Audit Trail
  sort: when
  sort_order: desc
  flags:
    - show_titles
  report_title: User Audit Trail
  actions:
    - print
    - export
  fields:
    - when: { width: 13%,name: Time }
    - what: { width: 12%, name: Action }
    - detail: { width: 74% }
  values:
    - collection.values: [session, $sid, user]
    - collection.data: [audit, [user], time, action, detail]
    - clear_values: [user]

partner:
  name: Organisation Audit Trail
  type: user
  access: [admin]
  fields:
    - when: { width: 15%, push: merge }
    - first_name: { width: 10%, push: what }
    - last_name: { width: 16%, push: what }
    - email: { width: 18%, push: what}
    - what: { width: 18%, push: merge }
    - detail: { width: 30%, push: merge }
  values:
    - _reset
    - collection.values: [session, $sid, partner]
    - collection.data: [audit, [partner], time, user.first_name, user.last_name, user.email, action, detail]
    - clear_values: [partner]

system:
  name: System Audit Trail
  type: partner
  access: [admin]
  fields:
    - organisation: { push: first_name, width: 12% }
  values:
    - _reset
    - collection.data: [audit, [], time, partner.name, user.first_name, user.last_name, user, action, detail]
