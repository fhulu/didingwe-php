# html controls
---
blank:
  type: template
  tag: span
  text: ""

button:
  class: [action]
  tag: button
  attr: { title: $desc }

captioned_image:
  tag: div
  class: [captioned-image]
  text: |
    <img src="$src" title="$title"></img>
    <p>$caption</p>
  title: $name
  src: $id.png
  caption: $name

checkbox:
  type: input
  attr: { type: checkbox }

class:
  type: template
  class: $id

container:
  tag: div
  text: $contents
  contents: []

control:
  html: <$tag>$text</$tag>
  tag: div
  attr: { id: $id }
  class: []
  text: $name

datatable:
  tag: table
  text: <tbody></tbody>
  class: [data]
  create: datatable
  script: /common/datatable.js
  row_creator: { type: table_row }
  css: /datatable.css
  flags: []
    # - editall
    #
  load:
    - call: datatable::read(context,$key)
  position: top
  filter: all
  filter:
    name: ""
    desc: Filter by specific columns
  #paging
  goto_first:
    name: First
    desc: Go to first page
  goto_prev:
    name: "<"
    desc: Go to previous page
  goto_next:
    name: ">"
    desc: Go to next page
  goto_last:
    name: Last
    desc: Go to last page

  # row actions
  row_actions:
    - action: post
  collapse:
    name: "-"
    desc: Hide details
  expand:
    name: +
    desc: More details ...
  slide:
    name: "<"
    desc: More options...
  slideoff:
    name: ">"
    desc: Hide options
  slideSpeed: 100

date:
  type: input
  create: datetimepicker
  timepicker: false
  format: Y-m-d
  script: /common/jquery.datetimepicker.js
  css: /common/jquery.datetimepicker.css

datetime:
  type: input
  create: datetimepicker
  format: Y-m-d H:i
  script: /common/jquery.datetimepicker.js
  css: /common/jquery.datetimepicker.css

date_time:
  type: date_time

disabled_input:
  type: input
  attr: disabled

disabled_text_input:
  type: disabled_input


div: {tag: div}

dropdown:
  unselected: --Select $name--
  inherit: [unselected,default]
  tag: select
  text: $options
  default:
    value: ""
    text: $unselected
  options:
    - type: dropdown_option
    - dropdown_default

dropdown_option:
  tag: option
  value: $1
  name: $2
  text: $name
  attr: { value: $value }

dropdown_default:
  value: ""
  text: $unselected

element:
  text: ""
  html: <$tag>$text</$tag>

#todo: fix backend inheritance
export:
  name: Export to Excel
  desc: Export to an Excel spreadsheet
  action: redirect
  validate: none
  call: datatable::export(context,$key)
  query: " "
  target: _blank

file:
  html: <div id="$id" name="$id"></div>
  create: file_uploader
  script: /common/file_uploader.js,/common/jquery.form.js
  css: /common/file_uploader.css
  uploader: /?action=upload
  max_size: 100

form:
  tag: form

#footer_actions:
#  - type: submit

google_map:
  tag: div
  create: mapper
  script: /common/map.js
  zoom: 5
  pin: blue_map_marker
  icon_path: /
  colors:
   - blue
   - green
   - yellow
   - orange
   - pink

h1:
  type: heading

h2:
  type: heading
  tag: h2

h3:
  type: heading
  tag: h3

heading:
  tag: h1
  name: $id

hidden:
  type: input
  attr: { type: hidden }

image:
  tag: img
  attr: {src: $src}
  src: $id.png
  text: ""

info_line:
  type: label_left
  label_suffix: ":"
  class: [info-line]

info_page:
  type: input_page
  lines: $inputs
  inherit: [label_suffix]
  label_suffix: ":"
  inputs:
    - type: info_text
    - template: info_line

info_text:
  tag: div
  class: [info-text]
  value: ""
  text: $value

inplace_input:
  type: template
  css: [/common/inplace_input.css]
  style: { display: $pack }
  text: |
      <a class=input>
        $field
        <span class=hint>$desc</span>
      </a>
  subject:
    attr: { placeholder: $name }

input:
  tag: input
  text: ""
  value: ""
  attr:
    type: text
    value: $value

input_page:
  type: page
  label_width: 24%
  input_width: 73%
  label_suffix: ":"
  pack: inline
  inherit: [desc, input_width, label_width, label_suffix, pack]
  loading: { type: processing }
  synopsis: { type: section_heading, text: $desc}
  text: $loading $synopsis $inputs $actions
  inputs:
    - template: labelled_input
    - type: input
  actions:
    - wrap: class
    - type: submit

label:
  tag: label

label_left:
  type: label_template
  label_suffix: ""
  pack: inline
  text: "<label style='display: $pack'>$name$label_suffix</label>$field"
  subject:
    style: { margin-right: 20px }

label_right:
  type: label_template
  text: $field<label>$name</label>

label_template:
  type: template
  tag: span

label_top:
  type: label_left
  pack: block

labelled_input:
  type: template
  style: { display: $pack }
  text: |
      <label style="width: $label_width">$name$label_suffix</label>
      <a class=input style="width: $input_width">
        $field
        <span class=hint>$desc</span>
      </a>

labelled_input_page:
  type: input_page

line:
  tag: hr
  text: ""

link:
  tag: a
  attr: { title: $desc }

list_item:
  tag: li

list_text:
  tag: li
  text: $id

menu:
  type: container
  tag: ul
  contents: $items
  items:
    - template: menu_item
    - type: link
    - action: redirect

menu_item:
  type: template
  tag: li

next:
  call: ""
  merge: true
  class: [action,wizard-jump]

one_cell_row:
  type: template
  text: <td>$field</td>

one_column_table:
  type: container
  tag: table
  contents: $items
  items:
    - template: one_cell_row

one_row_table:
  tag: table
  text: <tr>$items</tr>
  items:
    - template: table_cell

p: { tag: p}

page:
  tag: div
  attr: { title: $name }
  sub_page: true
  class: [page]

page_title:
  html: <title>$name</title>

paragraph:
  type: p

password_input:
  type: input
  attr: { type: password }

plain:
  tag: div
  value: $name
  text: $value

plain_text:
  type: plain

prev:
  call: ""
  merge: true
  class: [action,wizard-jump]

# todo: fix back-end to contextualise
print:
  desc: Print above contents
  action: redirect
  validate: none
  call: datatable::pdf(context,$key)
  query: " "
  target: _blank

processing:
  type: template
  tag: span
  class: [ajax_result]
  style: { display: none }


question_input:
  type: template
  text: <label>$question</label>$field

question_input_page:
  type: input_page
  inputs:
    - template: question_input

radiobox:
  type: input
  attr: { type: radio, value: $id}
  style:
    width: 24px
    height: 24px

radiogroup:
  tag: div
  class: radio
  text: $options
  group: $id
  inherit: [group]
  options:
    - template: label_left
    - type: radiobox
    - attr: { name: $group }

section_heading:
  tag: p
  class: [section-heading]

span:
  tag: span

submit:
  type: button
  selector: "#page *"
  validate: all
  call: $class::$invoker($key)
  action: post

sub_menu:
  type: template
  text: |
    <a id="$id">$name</a>
    <span>$sub_items</span>
  action: " "
  template: $field
  sub_items:
    - action: redirect
    - type: link

table:
  tag: table
  head: $table_head
  body: $table_body
  text: $head$body
  rows:
    - template: table_row

table_head:
  type: template
  tag: thead

table_body:
  type: template
  tag: tbody

table_cell:
  type: template
  tag: td

table_input:
  type: template
  class: [input]
  tag: tr
  text: |
    <td style="width:25%;">$name</td>
    <td>
      <a class=input style="width:98%">
        $field
        <span>$desc</span>
      </a>
    </td>

table_input_page:
  type: input_page
  text: |
    $processing
    $synopsis
    $form
  inherit: [inputs,actions]
  form:
    type: table
    class: [form]
    text: $inputs $actions
  inputs:
    - template: table_input

table_page:
  type: page
  tag: table
  text: $children
  children: [template: one_cell_row]

table_row:
  tag: tr
  text: $columns
  columns:
    - template: table_cell

template:
  tag: div
  text: $field
  attr: {id: ""}

text: { type: input }

textarea:
  tag: textarea
  value: ""
  text: $value

text_area: { type: textarea}

text_input: {type: input }


time:
  type: input
  create: datetimepicker
  datepicker: false
  format: H:i
  script: /common/jquery.datetimepicker.js
  css: /common/jquery.datetimepicker.css

titled_paragraph:
  html: >
    <div class=titled-paragraph>
      <p class=heading>$heading</p>
      <p class=text>$text</p>
    </div>
  heading: $name
  text: " "

wizard:
  tag: div
  create: wizard
  text: ""
  script: [/common/wizard.js]
  css: [/common/wizard.css]
  class: [wizard]
  prev_name: Previous
  next_name: Next

wizard_jump:
  type: button
  action: trigger
  event:
    name: wizard-jump
    parameters: { index: $id }

wizard_next:
  type: button
  action: trigger
  event: wizard-next
...
